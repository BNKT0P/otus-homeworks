# Автоматизированные тесты для домашних заданий DevOps курса в OTUS

Все тесты выполняются внутри докер контейнера express42/otus-homeworks.

**Как выполняются тесты.** Когда студент создает PR, Travis запускает `run.sh` из этого репозитория, который клонирует весь реп, устанавливает докер, определяет домашнее заданиее и запускает для него тесты.

**Как определяется домашнее задание.** Через ENV переменные Travis CI, скрипт получает название ветки, которое жестко задано в презентации для каждого ДЗ. Название ветки совпадает с названием папки с тестами в `homeworks/<branch name>`

**Как запускаются тесты.** `run.sh` дергает файл `./otus-homeworks/homeworks/<branch name>/run.sh` в котором описано выполнение действий, необходимых для проверки корректности домашнего задания.

**Структура директорий в контейнере во время выполнения тестов.** Travis клонирует ветку пользователя, заходит в нее, потом скрипт клонирует папку с тестами, затем запускается контейнер и монтирует папку в `/srv`(она же workdirectory). В результате структура папок во время выполнения следующая:

```
README.md -- файлы из репозитория пользователя
... 
otus-homeworks -- папка с автотестами
```



**Как добавить что-нибудь в контейнер.** Отредактировать Dockerfile, собрать образ `docker build -t express42/otus-homeworks`, запушить `docker push express42/otus-homeworks`.

## Пример .travis.yml

```
dist: trusty
language: bash
sudo: required

before_install:
  - curl https://raw.githubusercontent.com/express42/otus-homeworks/2018-02/run.sh | bash
```
